version: "3.9"
services:
  web:
    build:
      context: ./web
    ports:
      - "3000:3000"
      - "6020:8000"
    depends_on:
      - engine
  engine:
    build:
      context: ./engine
    environment:
      - INTOUCH2_HOST=192.168.50.167
      - INTOUCH2_MAC=68:27:19:be:a7:a2
      - MAX_SETPOINT_F=104
      - COMMAND_RATE_LIMIT_MS=1000
      - STATE_POLL_INTERVAL_MS=1500
      - STATE_LOG_INTERVAL_S=60
      - LOG_DIR=/data/logs
      - AUTOMATIONS_FILE=/data/automations.json
    volumes:
      - engine_data:/data

volumes:
  engine_data:
